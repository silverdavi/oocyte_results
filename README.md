# Data-Driven IVF Counseling: Oocyte Quality Assessment with Personalized Cycle Predictions

[![Paper](https://img.shields.io/badge/Paper-PDF-red)](main.pdf)
[![Data](https://img.shields.io/badge/Data-702_samples-blue)](https://zenodo.org/records/6390798)
[![License](https://img.shields.io/badge/License-Academic-green)](LICENSE)

**Authors:** David Silver, Gilad Rave  
**Institution:** Rhea Labs ‚äÇ Rhea Fertility, Singapore  
**Paper:** 19 pages, 5 figures, 42 references  

---

## üìÑ Paper Summary

This research presents a **dual-model framework** that revolutionizes IVF counseling by combining:

1. **üßÆ Parametric Calculator**: Age-dependent AMH interpretation for transparent oocyte yield predictions
2. **üî¨ AI Quality Assessment**: Vision Transformer model analyzing post-ICSI oocyte morphology for blastulation prediction

### Key Innovation
- **Post-ICSI, pre-2PN analysis**: Earliest possible oocyte quality prediction
- **Real clinical data**: 702 embryo samples from standardized time-lapse imaging
- **Evidence-based counseling**: Replacing population averages with personalized predictions

---

## üéØ Key Results

| **Metric** | **Parametric Calculator** | **Oocyte Quality Model** |
|------------|---------------------------|---------------------------|
| **Purpose** | Oocyte yield prediction | Blastulation success prediction |
| **Input** | Age + AMH levels | Post-ICSI oocyte images |
| **Output** | Transparent yield estimates | Quality scores + classification |
| **Performance** | Age-dependent percentiles | r=0.421, 71.1% accuracy, 97.6% sensitivity |
| **Clinical Value** | Immediate counseling tool | Objective embryologist support |

---

## üìä Publication Figures

### Figure 1: Parametric Calculator - AMH vs Oocyte Predictions
![AMH Calculator](figures/calculator_amh_oocytes.png)
*Age-dependent AMH interpretation showing personalized oocyte yield predictions across different AMH percentiles*

### Figure 2: Parametric Calculator - Age vs Oocyte Predictions  
![Age Calculator](figures/calculator_age_oocytes.png)
*Age-stratified oocyte yield analysis demonstrating declining fertility patterns with clinical thresholds*

### Figure 3: Oocyte Quality - Prediction Correlation
![Correlation Analysis](figures/oocyte_correlation.png)
*Correlation between predicted quality scores and actual blastulation outcomes (r=0.421, p<0.001)*

### Figure 4: Oocyte Quality - ROC Performance Comparison
![ROC Comparison](figures/oocyte_roc_comparison.png)
*Model performance vs random baseline with cross-validation analysis (AUC=0.661 vs 0.5)*

### Figure 5: Oocyte Quality - Classification Metrics
![Classification Metrics](figures/oocyte_classification_metrics.png)
*Comprehensive performance metrics: 71.1% accuracy, 97.6% sensitivity, 40.8% specificity*

---

## üìÅ Complete Repository Structure

```
üì¶ oocyte_paper/
‚îú‚îÄ‚îÄ üìÑ main.tex                           # Main LaTeX document
‚îú‚îÄ‚îÄ üìï main.pdf                           # Compiled paper (19 pages)
‚îú‚îÄ‚îÄ üìÇ sections/                          # Paper sections
‚îÇ   ‚îú‚îÄ‚îÄ introduction.tex                  # Problem statement & motivation
‚îÇ   ‚îú‚îÄ‚îÄ methods.tex                       # Methodology & implementation
‚îÇ   ‚îú‚îÄ‚îÄ results.tex                       # Results & performance metrics
‚îÇ   ‚îú‚îÄ‚îÄ discussion.tex                    # Clinical implications
‚îÇ   ‚îî‚îÄ‚îÄ conclusion.tex                    # Summary & future work
‚îú‚îÄ‚îÄ üñºÔ∏è figures/                           # Publication-ready figures
‚îÇ   ‚îú‚îÄ‚îÄ calculator_amh_oocytes.png        # AMH vs oocyte predictions
‚îÇ   ‚îú‚îÄ‚îÄ calculator_age_oocytes.png        # Age vs oocyte predictions
‚îÇ   ‚îú‚îÄ‚îÄ oocyte_correlation.png            # Quality correlation analysis
‚îÇ   ‚îú‚îÄ‚îÄ oocyte_roc_comparison.png         # ROC performance comparison
‚îÇ   ‚îî‚îÄ‚îÄ oocyte_classification_metrics.png # Classification performance
‚îú‚îÄ‚îÄ üìö references.bib                     # 42 comprehensive references
‚îú‚îÄ‚îÄ üìä binary_labels/                     # Binary classification data & results
‚îÇ   ‚îú‚îÄ‚îÄ blastulation_binary_labels.csv    # Binary outcome labels (702 samples)
‚îÇ   ‚îú‚îÄ‚îÄ binary_cross_validation_results.csv # 8-fold CV results
‚îÇ   ‚îú‚îÄ‚îÄ binary_training.log               # Training logs
‚îÇ   ‚îî‚îÄ‚îÄ *.py                              # Training & inference scripts
‚îú‚îÄ‚îÄ üìà continuous_labels/                 # Continuous quality scores
‚îÇ   ‚îú‚îÄ‚îÄ blastulation_quality_scores.csv   # Quality scores (0-1 range)
‚îÇ   ‚îú‚îÄ‚îÄ continuous_cross_validation_results.csv # CV performance
‚îÇ   ‚îî‚îÄ‚îÄ continuous_training.log           # Training records
‚îú‚îÄ‚îÄ üßÆ calculator/                        # Parametric calculator
‚îÇ   ‚îî‚îÄ‚îÄ parametric_cycle_calculator.py    # Age-dependent AMH calculator
‚îú‚îÄ‚îÄ üî¨ data_analysis/                     # Analysis pipeline
‚îÇ   ‚îú‚îÄ‚îÄ analyze_binary_model.py           # Binary model analysis
‚îÇ   ‚îú‚îÄ‚îÄ analyze_continuous_model.py       # Continuous model analysis  
‚îÇ   ‚îú‚îÄ‚îÄ analyze_parametric_calculator.py  # Calculator analysis
‚îÇ   ‚îú‚îÄ‚îÄ run_all_analyses.py              # Complete pipeline runner
‚îÇ   ‚îî‚îÄ‚îÄ processed/                        # Processed results & metrics
‚îú‚îÄ‚îÄ üìä plotting/                          # Figure generation scripts
‚îÇ   ‚îú‚îÄ‚îÄ plot_calculator_focused.py        # Calculator visualization
‚îÇ   ‚îú‚îÄ‚îÄ plot_oocyte_quality_focused.py   # Quality assessment plots
‚îÇ   ‚îú‚îÄ‚îÄ plot_binary_model.py             # Binary model figures
‚îÇ   ‚îú‚îÄ‚îÄ plot_continuous_model.py         # Continuous model figures
‚îÇ   ‚îú‚îÄ‚îÄ create_all_plots.py              # Generate all figures
‚îÇ   ‚îî‚îÄ‚îÄ figures/                          # Generated figure outputs
‚îú‚îÄ‚îÄ üêç requirements.txt                   # Python dependencies
‚îú‚îÄ‚îÄ üìã paper_analysis_plan.md            # Detailed methodology
‚îú‚îÄ‚îÄ üìù references_validated.md           # Reference validation notes
‚îî‚îÄ‚îÄ üé® sn-*.bst                          # Springer Nature styles
```

---

## üî¨ Methodology

### Parametric Calculator
- **Age-dependent AMH percentiles** from clinical population data
- **Transparent mathematical relationships** avoiding black-box complexity
- **Sigmoid functions** modeling oocyte yield based on established literature

### Vision Transformer Model  
- **Architecture**: ViT-Base/16 with 86M parameters
- **Input**: 224√ó224 post-ICSI oocyte images (pre-2PN timing)
- **Training**: 8-fold cross-validation on 702 real clinical samples
- **Dataset**: [Gomez et al. 2022](https://zenodo.org/records/6390798) time-lapse embryo data

### Statistical Validation
- **Cross-validation**: 8-fold stratified sampling
- **Baselines**: Random, majority class, label-shuffled comparisons  
- **Significance testing**: Mann-Whitney U tests with Cohen's d effect sizes

---

## üöÄ Quick Start

### 1. Clone Repository
```bash
git clone https://github.com/silverdavi/oocyte_paper.git
cd oocyte_paper
```

### 2. Install Dependencies
```bash
pip install -r requirements.txt
```

### 3. Run Complete Analysis
```bash
# Generate all processed results
cd data_analysis/
python run_all_analyses.py

# Create all figures  
cd ../plotting/
python create_all_plots.py
```

### 4. Compile Paper
```bash
# Generate final PDF
pdflatex main.tex
bibtex main
pdflatex main.tex
pdflatex main.tex
```

---

## üìà Clinical Impact

### Current Problems Solved
- **‚ùå Population-based counseling** ‚Üí **‚úÖ Personalized predictions**
- **‚ùå Subjective embryo assessment** ‚Üí **‚úÖ Objective AI-assisted evaluation**  
- **‚ùå Fixed AMH thresholds** ‚Üí **‚úÖ Age-dependent interpretation**
- **‚ùå Late-stage decision making** ‚Üí **‚úÖ Early post-ICSI assessment**

### Implementation Benefits
- **üéØ Evidence-based counseling** with realistic expectations
- **‚ö° Real-time predictions** for immediate clinical use
- **üìä Transparent methodology** for regulatory compliance
- **üî¨ Objective quality assessment** reducing inter-observer variability

---

## üìä Dataset Information

**Source**: [Gomez et al. 2022 Time-lapse Embryo Dataset](https://zenodo.org/records/6390798)
- **üìπ 704 time-lapse videos** with 2.4M images across 7 focal planes
- **üè• Clinical data**: ICSI cycles from University Hospital of Nantes (2011-2019)
- **üî¨ Acquisition**: Embryoscope¬© system with standardized protocols
- **üéØ Our subset**: 702 samples with complete blastulation outcomes

---

## üîó Related Publications

This research builds upon our previous work:
- **[Fordham et al. 2022](https://pubmed.ncbi.nlm.nih.gov/35944167/)** - *Human Reproduction*: Inter-observer variability in embryo assessment
- **[Rave et al. 2024](https://dl.acm.org/doi/10.1007/978-3-031-67285-9_12)** - *AIiH Conference*: Bonna Algorithm for implantation prediction

---

## üìã Citation

```bibtex
@article{silver2024ivf,
    title={Data-Driven IVF Counseling: Integrating Oocyte Quality Assessment with Personalized Cycle Predictions},
    author={Silver, David H and Rave, Gilad},
    journal={In Preparation},
    year={2024},
    institution={Rhea Labs, Rhea Fertility},
    note={Repository: https://github.com/silverdavi/oocyte_paper}
}
```

---

## üìû Contact

**üî¨ Research Questions:**
- **David Silver**: david.silver@rhea-fertility.com
- **Gilad Rave**: gilad.rave@rhea-fertility.com

**üè¢ Institution**: Rhea Labs ‚äÇ Rhea Fertility, Singapore

**ü§ù Collaborations**: Open to academic and clinical partnerships

---

## üìú License

This research is intended for **academic and clinical research purposes**. 
Please contact the authors for collaboration opportunities and commercial licensing.

---

<div align="center">

**Rhea Labs** ‚äÇ **Rhea Fertility**  
*Advancing reproductive medicine through data-driven innovation*

[üåê Website](https://rhea-fertility.com) | [üìß Contact](mailto:david.silver@rhea-fertility.com) | [üìÑ Paper](main.pdf)

</div> 